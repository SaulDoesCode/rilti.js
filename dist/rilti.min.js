{const b=void 0,a=Array.isArray,c=(a)=>a===b||null===a,d=(a)=>a!==b&&null!==a,e=(a)=>a instanceof Function,f=(a)=>'boolean'==typeof a,g=(a)=>'object'==typeof a&&a.constructor===Object,h=(a)=>'string'==typeof a,i=(a)=>'number'==typeof a&&!isNaN(a),j=(a)=>i(a)&&0==a%1,k=(b)=>a(b)||b instanceof NodeList||d(b)&&!(e(b)||m(b))&&0==b.length%1,l=(a,b=!0)=>a instanceof NodeList||b&&s(a,m),m=(a)=>a instanceof Node,p=(a)=>(a=typeof a,'string'===a||'number'===a||'boolean'===a),n=(a)=>'object'==typeof a&&e(a.then),o=(a)=>a instanceof RegExp,q=(a)=>a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement,r=(a)=>a instanceof Node||aa(a)||p(a)||s(a,r),s=(a,b)=>{if(k(a)){const c=b instanceof Function;for(let d=0;d<a.length;d++)if(c?!b(a[d]):a[d]!==b)return!1;return!0}return!1},t=(a,c=a.length,...d)=>c<=d.length?a(...d):t.bind(b,a,c,...d),u=(b,c=[],d=!0)=>{if(d&&!a(b))return[b];for(var e=0;e<b.length;e++)a(b[e])?u(b[e],c):c.push(b[e]);return c},v=(a,...b)=>setTimeout(a,0,...b),w=(a)=>{document.body||'complete'===document.readyState?setTimeout(a,0):window.addEventListener('DOMContentLoaded',a)},x=(a,b)=>{if(d(a))if(g(a))for(const c in a)b(a[c],c,a);else if(a.length){const c=a.length;for(let d=0;d!==c;)b(a[d],d++,a)}else if(a.forEach)a.forEach(b);else if(j(a))for(let c=0;c<=a;)b(c++,a);return a},y=(a,b=document)=>m(a)?a:y(b).querySelector(a),z=(a,b,c)=>{document.body?b(y(a,c)):w(()=>b(y(a,c)))},A=(a,b=document)=>Array.from(y(b).querySelectorAll(a)),B=(a,b,c=document)=>(e(b)||([b,c]=[c,document]),x(A(a,c),b)),C=t((a,c,d,f,i=!1)=>{if(h(c)&&(c=y(c)),g(d)){for(const b in d)d[b]=C(a,c,b,d[b],i);return d}if(!e(f))return C.bind(b,a,c,d);f=f.bind(c);const j=m(c)?ba(c):c,k=(b)=>{f(b,j),a&&l()},l=()=>(c.removeEventListener(d,k),o),n=(b)=>(a=!!b,c.addEventListener(d,k,i),o),o={handler:k,on:n,off:l,once:n.bind(b,!0)};return n(a)},3),D={get:(a,b)=>(c,d,e)=>a(c,b,d,e)},E=new Proxy(C(!0),D),F=new Proxy(C(!1),D),G=(a,b,c)=>(a.dispatchEvent(new CustomEvent(b,{detail:c})),a),H=(a,c=!1)=>new Proxy(a,{get:(a,d)=>c&&d in a&&Reflect.get(a,d)||a.bind(b,d)}),I=(a={},b=new Map)=>Object.assign(a,{listeners:b,emit:H((a,...c)=>{b.has(a)&&b.get(a).forEach((a)=>a(...c))}),emitAsync:H((a,...c)=>v(()=>{b.has(a)&&b.get(a).forEach((a)=>v(a,...c))})),on:H((c,d)=>(b.has(c)||b.set(c,new Set),b.get(c).add(d),()=>a.off(c,d))),once:H((b,c)=>a.on(b,function d(){c(...arguments),a.off(b,d)})),off:H((a,c)=>{if(b.has(a)){const d=b.get(a);d.delete(c),d.size||b.delete(a)}})}),J=(a,b)=>{const c=ba(a);for(const d in b){let f=b[d];if(d in a)a[d]=f;else if('accessors'==d)for(const b in f){const{set:d=f[b],get:g=f[b]}=f[b],h={};e(d)&&(h.set=d.bind(a,c)),e(g)&&(h.get=g.bind(a,c)),Object.defineProperty(a,b,h)}else!e(f)||aa(f)||sa(f)?Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(b,d)):a[d]=f.call(a,c)}},K=(a,b)=>{const c=ba(a);for(const d in b)Object.defineProperty(a,d,{value:b[d].bind(a,c)})},L=(a,b=document)=>l(a)?Array.from(a).every((a)=>L(a)):b===a||!!(16&b.compareDocumentPosition(a)),M=(a)=>(b,c)=>a[f(c)?c?'add':'delete':'has'](b),N=M(new WeakSet),O=M(new WeakSet),P=M(new WeakSet),Q=(a,b=!N(a),c=da(a))=>{b&&!c&&(N(a,!0),G(a,'create'))},R=(a)=>{const b=da(a);Q(a,!N(a),b),O(a)||(P(a)?(P(a,!1),G(a,'remount')):b?fa(a,'mount'):(O(a,!0),G(a,'mount')))},S=(a)=>{O(a,!1),P(a,!0),G(a,'unmount')},T=(b,c)=>(b instanceof Function&&(b=b(c)),'string'==typeof b)?Array.from(document.createRange().createContextualFragment(b).childNodes):b instanceof Node?b:a(b)?b.map((a)=>T(a)):void 0,U=(a)=>a===b?document.createDocumentFragment():T(a),V=(b,c,d='appendChild',e=U(),f)=>{for(var g=0;g<b.length;g++){let f=b[g];if(f instanceof Function)if((f=f(c))===c)continue;else if(f instanceof Function){let a=0,b=!1;for(;f instanceof Function&&25>a&&(f=f(),!(b=f===c));)a++;if(b)continue}if('string'==typeof f){if(!f.length)continue;f=new Text(f)}else a(f)&&(f=V(f,c,d,e,!0));f instanceof Node&&(e.appendChild(f),R(f))}return c&&!f?void c[d](e):e},W=(...c)=>{for(let e,f=0;f<c.length;f++){if(e=c[f],e instanceof Node||e instanceof Function)continue;else if(p(e)){c[f]=new Text(e);continue}const h=e instanceof NodeList;if(h){if(2>e.length){c[f]=e[0];continue}e=Array.from(e)}else g(e)&&(e=Object.values(e));if(a(e)){if(!h&&(e=W.apply(b,e),2>e.length)){c[f]=e[0];continue}const a=e.length;e.unshift(f,1),c.splice.apply(c,e),e.slice(2,0),f+=a}else if(d(e))throw new Error(`illegal renderable: ${e}`)}return c},X=(b,c,...d)=>{b instanceof Function&&(b=b());const e=b instanceof Node;if(d=W(d),e)'after'!==c&&'before'!==c||L(b)?V(d,b,c):E.mount(b,()=>X(b,c,...d));else if(h(b))return z(b,(a)=>X(a,c,...d));return a(b)&&b.push(...d),2>d.length?d[0]:d},Y=(a,b=document.body||'body',c='appendChild')=>X(b,c,a),Z={css(a,b,c){if(g(b))for(const c in b)Z.css(a,c,b[c]);else h(b)&&(0===b.indexOf('--')?a.style.setProperty(b,c):a.style[b]=c);return a},class(b,d,c=!b.classList.contains(d)){if(a(b))for(let a=0;a<b.length;a++)Z.class(b[a],d,c);if(g(d))for(const a in d)Z.class(b,a,f(d[a])?d[a]:!b.classList.contains(a));else h(d)&&(d=d.split(' ')),a(d)&&d.forEach((a)=>{b.classList[(f(c)?c:!b.classList.contains(a))?'add':'remove'](a)});return b},hasClass:t((a,b)=>a.classList.contains(b)),attr(d,e,a){if(g(e))for(const f in e){const a=c(e[f]);d[a?'removeAttribute':'setAttribute'](f,e[f]),oa(d,f,b,e[f],!a)}else if(h(e)){if(c(a))return d.getAttribute(e);const b=d.getAttribute(e);d.setAttribute(e,a),oa(d,e,b,a)}return d},removeAttribute(a,...c){return u(c).forEach((c)=>{a.removeAttribute(c),oa(a,c,b,b,!1)}),a},attrToggle(a,b,c=!a.hasAttribute(b),d=a.getAttribute(b)||''){return a[c?'setAttribute':'removeAttribute'](b,d),oa(a,b,c?d:null,c?null:d,c),a},emit:G,append:(a,...b)=>X(a,'append',...b),prepend:(a,...b)=>X(a,'prepend',...b),appendTo:(a,b)=>X(b,'append',a),prependTo:(a,b)=>X(b,'prepend',a),clear(a){return a[q(a)?'value':'innerHTML']='',a},remove(b,c){return(e(b)&&(b=b()),a(b))?b.forEach((a)=>Z.remove(a,c)):(i(c)?setTimeout(()=>Z.remove(b),c):L(b)?b.remove():l(b)&&Array.from(b).forEach((a)=>Z.remove(a)),b)}},_=new Map,aa=M(new WeakSet),ba=(c)=>{if(aa(c))return c;if('string'==typeof c&&(c=y(c)),_.has(c))return _.get(c);if(!m(c))throw new TypeError(`$ needs a Node: ${c}`);const d=new Proxy(Z.class.bind(b,c),{get:(a,b)=>c.classList.contains(b),set:(a,b,c)=>a(b,c),deleteProperty:(a,b)=>!!c.classList.remove(b)}),f=new Proxy(Z.attr.bind(b,c),{get(a,d){return'has'===d?(a)=>c.hasAttribute(a):'remove'===d||'rm'===d?Z.removeAttribute.bind(b,c):c.getAttribute(d)},set(a,b,d){return'remove'===b?Z.removeAttribute(c,d):a(b,d),!0},deleteProperty:(a,b)=>Z.removeAttribute(c,b)}),g=q(c)?'value':'textContent',i=q(c)?'value':3===c.nodeType?g:'innerHTML',j=H(C(!0,c),!1),k=H(C(!1,c),!1),l=new Proxy((a)=>(e(a)&&!aa(a)&&a.call(c,l,c),c),{get(a,b){return'class'===b?d:'attr'===b?f:'txt'===b?c[g]:'html'===b?c[i]:'on'===b?k:'once'===b?j:'emit'===b?(G.bind(c,c),l):'mounted'===b?L(c):'render'===b?Y.bind(c,c):'children'===b?Array.from(c.children):'$children'===b?Array.from(c.children).map(ba):'parent'===b&&c.parentNode?ba(c.parentNode):b in Z?(...a)=>{const d=Z[b](c,...a);return d===c?l:d}:!e(c[b])||aa(c[b])||sa(c[b])?c[b]:c[b].bind(c)},set(b,e,j){return'class'===e?d(c,j):'attr'===e?f(c,j):'css'===e?Z.css(c,j):'txt'===e?c[g]=j:'html'===e||'children'===e?h(j)?c[i]=j:(c[g]='',V(a(j)?W(j):T(j),c)):c[e]=j,!0}});return _.set(c,l),aa(l,!0),l},ca=(a)=>a!==b&&(a.tagName||(a+'').toUpperCase()),da=(a)=>ea.has(ca(a)),ea=new Map,fa=(a,b,c,d)=>{if(1===a.nodeType&&ea.has(a.tagName)){h(b)?[c,b]=[b,ea.get(a.tagName)]:!g(b)&&(b=ea.get(a.tagName));const{create:e,mount:f,remount:i,unmount:j,props:k,methods:l,attr:m}=b,n=ba(a);if(!N(a)){if(l&&K(a,l),k&&J(a,k),d&&J(a,d),N(a,!0),e&&e.call(a,n),G(a,'create'),g(m))for(const b in m)ma(a,b,m[b]);i&&F.remount(a,i.bind(a,n))}return O(a)||'mount'!==c?'unmount'===c&&(O(a,!1),P(a,!0),j&&j.call(a,n),G(a,c)):P(a)?(i&&i.call(a,n),G(a,'remount')):(O(a,!0),f&&f.call(a,n),G(a,c)),a}},ga='http://www.w3.org/2000/svg',ha=new Proxy((...a)=>ja(document.createElementNS(ga,'svg'),...a),{get:(a,b)=>(...a)=>ja(document.createElementNS(ga,b),...a)}),ia=H(function(c,d){const e='string'==typeof c?document.createElement(c):c;let f=Array.prototype.slice.call(arguments,2);if(g(d))for(const a in d)a in e?e[a]=d[a]:'$'==a||'render'==a?d[a].nodeType?d[a].appendChild(e):X(d[a],'appendChild',e):Z.hasOwnProperty(a)?Z[a](e,d[a]):0===a.indexOf('on')?F(e,d[a]):0===a.indexOf('once')?E(e,d[a]):e.setAttribute(a,d[a]);else'string'==typeof d?e.appendChild(new Text(d)):d instanceof Node?e.appendChild(d):d instanceof Function?f.unshift(d(e)):(a(d)||d instanceof NodeList)&&(f=Array.prototype.concat.call(d,f));if(f.length){const c=U();for(let d,g=0;g<f.length;g++)d=f[g],d instanceof Function&&(d=d(e)),d instanceof Node?c.appendChild(d):a(d)?V(d,e,'appendChild',c,!0):d!==b&&c.appendChild(new Text(d));e.appendChild(c)}return e}),ja=H(Object.assign((c,d,...f)=>{const h='string'==typeof c?document.createElement(c):c,i=ea.has(h.tagName);if(i)var j;const k=ba(h);if(3!==h.nodeType){if(aa(d)&&d!==k)f.unshift(d(k));else if(d instanceof Function){const a=d.call(h,k);d=a!==h&&a!==k?a:b}else r(d)&&f.unshift(d);f.length&&X(h,'appendChild',...f)}if(g(d)){var l=d.pure;for(const b in!i&&d.props&&J(h,d.props),d.methods&&K(h,d.methods),d.sync&&(d.sync=d.sync(h)),d){let c=d[b];const f=0===b.indexOf('once'),g=!f&&0===b.indexOf('on');if(f||g){const e=f?4:2,g=b.substr(0,e);let i=b.substr(e);const j=C(f),k=a(c)?c:[c];d[g]||(d[g]={}),d[g][i]=i.length?j(h,i,...k):j(h,...k)}else b in h?e(h[b])?a(c)?h[b].apply(h,c):h[b](c):h[b]=d[b]:b in Z&&(c=a(d[b])?Z[b](h,...c):Z[b](h,c),c!==h&&(d[b]=c))}if(d.cycle){const{mount:a,create:b,remount:c,unmount:e}=d.cycle;b&&E.create(h,b.bind(h,k)),a&&E.mount(h,a.bind(h,k)),d.cycle.unmount=e&&F.unmount(h,e.bind(h,k)),d.cycle.remount=c&&F.remount(h,c.bind(h,k))}i&&(fa(h,b,b,d.props),j=!0);const c=d.$||d.render;c?X(c,'appendChild',h):d.renderAfter?X(d.renderAfter,'after',h):d.renderBefore&&X(d.renderBefore,'before',h)}return i?!j&&fa(h,b):Q(h,!0,i),l?h:k},{text:(a,c='')=>(p(a)&&([c,a]=[a,b]),ja(new Text(c),a)),body:(...a)=>(Y(a=W(a)),1<a.length?a:a[0]),svg:ha,frag:U,prime:W,html:T}),!0),ka=new Map,la=(a,b)=>ka.has(a)&&ka.get(a)(b),ma=(a,b,c)=>{a=ba(a);const{init:d,update:e,remove:f}=c,g=(c,e)=>c&&!la(b,a)?(d&&d(a,e),ka.has(b)||ka.set(b,M(new WeakSet)),ka.get(b)(a,!0),!0):la(b,a);let h=!1,i=a.getAttribute(b);g(a.hasAttribute(b),i);const j=a.on.attr(({detail:{name:c,value:d,oldvalue:j,present:k}})=>{b===c&&i!==d&&d!==j&&g(k,d)&&(k?(e&&e(a,d,i),h=!1):!h&&(f&&f(a,d,i),h=!0),i=d)}).off;return()=>{j(),ka.has(b)&&ka.get(b)(a,!1)}},na=new Map,oa=(a,b,c,d=a.getAttribute(b),e=a.hasAttribute(b))=>{na.has(b)&&na.get(b).init(ba(a)),G(a,'attr',{name:b,value:d,oldvalue:c,present:e})},pa=(a)=>fa(a,'mount')||R(a),qa=(a)=>fa(a,'unmount')||S(a);new MutationObserver((a)=>{for(let b=0;b<a.length;b++){const{addedNodes:c,removedNodes:d,attributeName:e}=a[b];if(c.length)for(let a=0;a<c.length;a++)pa(c[a]);if(d.length)for(let a=0;a<d.length;a++)qa(d[a]);'string'==typeof e&&oa(a[b].target,e,a[b].oldValue)}}).observe(document,{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0});const ra=(a,b={})=>(a.forEach((a,c)=>{b[c]=a}),JSON.stringify(b)),sa=M(new WeakSet),ta={isArr:a,isNil:c,isDef:d,isObj:g,isFunc:e,isBool:f,isStr:h,isNum:i,isArrlike:k,isNodeList:l,isNode:m,isPrimitive:p,isPromise:n,isRenderable:r,isRegExp:o,isInput:q,isEmpty:(a)=>c(a)||!((g(a)?Object.keys(a):a).length||a.size),isEl:(a)=>a instanceof Element,attributeObserver:ma,flatten:u,curry:t,compose:(...a)=>a.reduce((c,a)=>(...b)=>c(a(...b))),components:ea,component:(a,b)=>{if(!a.includes('-'))throw new Error(`component: ${a} tagName is un-hyphenated`);return ea.set(a.toUpperCase(),b),w(()=>B(a,fa)),ja[a]},run:w,render:Y,runAsync:v,query:y,queryAsync:z,queryAll:A,queryEach:B,on:F,once:E,emitter:I,each:x,svg:ha,fastdom:ia,dom:ja,domfn:Z,html:T,directive:(a,{init:b,update:c,remove:d,accessors:e,toggle:f})=>{const g=new Map;g.init=(e)=>{la(a,e)||g.set(e,ma(e,a,{init:b,update:c,remove:d}))},g.stop=(a)=>{g.has(a)&&g.get(a)()},na.set(a,g),w(()=>B('['+a+']',(b)=>oa(b,a)))},directives:na,prime:W,map2json:ra,model:(i,j=I(),k=new Map)=>{let l;const{emit:p,emitAsync:r,on:t,once:v}=j,w=(b,c)=>(a(b)?b.forEach((a)=>w(a,c)):(k.delete(b),!c&&(p('delete',b),p('delete:'+b))),z),y=(a)=>k.has(a),z=(b,e,f)=>{if(g(b)){for(const a in b)c(b[a])?w(a,e):z(a,b[a],e);return l}if(a(b)){for(var h=0;h<b.length;h++)z(b[h][0],b[h][1],e);return l}else{const a=k.get(b);return d(e)&&e!==a?(k.set(b,e),f||(p('set',b,e),p('set:'+b,e)),e):(f||(p('get',b),p('get:'+b)),a)}},A=new Map,B=new Proxy(function(b,c,d=c){if(a(b)){const a=Array.from(arguments).slice(1);if(a.every(h))return B.template(b,...a)}else aa(b)&&'html'!==c&&(b=b());const e=q(b);e&&([d,c]=[c,'value']),A.has(b)||A.set(b,new Map);let f='set';if(d.includes(':')){[f,d]=d.split(':');var g='valid'===f,i='compute'===f;g&&(f='validate')}if(A.get(b).set(d,t(f+':'+d,(a)=>{b[c]=a})),!g&&e)var j=ba(b).on.input(()=>{z(d,b[c].trim()),D.has(d)&&E(d)});return g?b[c]=E(d):i&&G.has(d)?b[c]=H(d):y(d)&&(b[c]=z(d)),v('delete:'+d,()=>{j&&j(),B.stop(b,d)}),b},{get(a,b){return Reflect.has(a,b)?Reflect.get(a,b):(d,e)=>c(d)?B.text(b):(c(e)&&!q(d)&&(m(d)&&(d=ba(d)),aa(d)&&(e='html')),a(d,e,b))}});B.stop=(a,b)=>{if(y(a)){const c=A.get(a);b?c.has(b)&&(c.get(b).off(),c.delete(b)):c.forEach((a)=>a.off()).clear(),c.size||A.delete(a)}return a},B.text=new Proxy((a)=>B(new Text,'textContent',a),{get:(a,b)=>a(b)}),B.template=(a,...b)=>u(b.reduce((b,c,d)=>[b,B.text(c),a[d+1]],a[0]).filter((a)=>!h(a)||a.length));const C=new Proxy((a,b)=>y(a)?b(k.get(a)):v('set:'+a,b),{get:(a,b)=>new Promise((a)=>{y(b)?a(k.get(b)):v('set:'+b,a)}),set:(a,c,d)=>d.then(z.bind(b,c))}),D=new Map,E=(a)=>{const b=k.has(a)&&D.has(a)&&D.get(a)(k.get(a));return p('validate:'+a,b),p('validate',a,b),b},F=new Proxy((a,b)=>{if(c(b))return E(a);if(o(b)){const a=b;b=(b)=>h(b)&&a.test(b)}if(e(b)){if(!f(b()))throw new Error(`".${a}": validator invalid`);D.set(a,b)}},{get:(a,b)=>E(b),set:(a,b,c)=>a(b,c)}),G=new Map,H=new Proxy(function(a,b){if(e(b))G.set(a,b);else if(h(b)&&s(arguments,h)){const a={};return x(arguments,(b)=>{a[b]=H(b)}),a}if(G.has(a)){const b=G.get(a),c=b(l);return b.result!==c&&(r('compute:'+a,c),r('compute',a,c),b.result=c),c}g(a)&&x(a,(a,b)=>H(b,a))},{get:(a,b)=>a(b),set:(a,b,c)=>a(b,c)}),J=()=>Array.from(k.entries());if(h(i))try{z(JSON.parse(i),!0)}catch(a){}else d(i)&&z(i,!0);return l=new Proxy(Object.assign(z,j,{compute:H,async:C,valid:F,each:(a)=>(k.forEach(a),l),has:y,del:w,map:(a)=>(k.forEach((b,d)=>{const e=a(b,d);c(e)||e===b||k.set(d,b)}),l),filter:(a)=>(k.forEach((b,c)=>{a(b,c)||k.delete(c)}),l),store:k,sync:B,syncs:A,toJSON:()=>ra(k),toArray:J,toJSONArray:()=>JSON.stringify(J())}),{get:(a,b)=>Reflect.has(a,b)?a[b]:'size'===b?k.size:z(b),set:(a,b,c)=>n(c)?C(b,c):z(b,c),delete:(a,b)=>w(b)}),sa(l,!0),l},Mounted:O,Unmounted:P,Created:N,ProxiedNodes:_,$:ba};'function'==typeof define&&define.amd?define([],()=>ta):'object'==typeof module&&module.exports?module.exports=ta:this.rilti=ta}